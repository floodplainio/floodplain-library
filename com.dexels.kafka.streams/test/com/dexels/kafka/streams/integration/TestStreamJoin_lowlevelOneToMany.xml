<joins tenants="testcase">
    <mongodb.sink>
        <sink collection="TestStreamJoin1" topic="@PERSON">
        </sink>
    </mongodb.sink>
    <join>
    	<store topic="TestStreamJoin-PERSON">
        </store>
        <store topic="TestStreamJoin-PURCHASE">
        </store>
        
        <groupedStore name="purchasebyperson" from="TestStreamJoin-PURCHASE" key="personid"/>
        <join name="personwithpurchases" from="TestStreamJoin-PERSON" withList="purchasebyperson"  remoteKey="personid" into="Purchase" optional="false" to="@PERSON"/>
    </direct>
  
</joins>