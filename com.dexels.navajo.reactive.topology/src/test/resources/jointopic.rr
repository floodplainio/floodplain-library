
|>database(resource='dvd',schema='public',table='country')
	->joinWith(|>database(resource='dvd',schema='public',table='city')
					->group(key=ToString([country_id]))
				,into='cities'
		)
	->set(citylist=[@cities/])
    ->sink(connector='replication',collection='countrywithcities','@CITYWITHCOUNTRY')
