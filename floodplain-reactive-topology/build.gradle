/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
 
plugins {
    // Apply the java-library plugin to add support for Java Library
    id 'java'
	id 'distribution'
	id 'application'
  	id 'com.github.johnrengelman.shadow'
    id 'maven-publish'
  }
mainClassName = 'io.floodplain.runtime.Main'

def globalConf = rootProject.ext


dependencies {
    Map<String, String> dependencies = globalConf.commonDependencies
    implementation project(':immutable-api')
    implementation project(':immutable-impl')
    implementation project(':replication-api')
    implementation project(':replication-impl')
    implementation project(':replication-json')
    implementation project(':floodplain-api')
    implementation project(':floodplain-document')
    implementation project(':floodplain-core')
    implementation project(':floodplain-reactive')
    implementation project(':floodplain-version')
    implementation project(':floodplain-document-stream')
    implementation project(':floodplain-function')
    implementation project(':config-runtime')
    implementation project(':pubsub-rx2')
    implementation project('::streams')
    implementation project('::streams-api')
    implementation project(':kafka-converter')
    compile dependencies.slf4j
    compile dependencies.jacksonCore
    compile dependencies.jacksonDatabind
    compile dependencies.osgiCompendium
    compile dependencies.cdiApi
    compile dependencies.reactiveStreams
    compile dependencies.rxJava
    testCompile dependencies.jUnit
	testImplementation dependencies.slf4jLog4j
 }

shadowJar {
    mergeServiceFiles {
        path = 'META-INF/custom'
        exclude 'META-INF/services/javax.xml.stream.*'
    }
}

//publishing {
//    publications {
//        shadow(MavenPublication) {
//            from components.java
//            artifact shadowJar
//            groupId = "io.floodplain"
//            artifactId = "topology-shadow"
//            version = rootProject.ext.floodplain_version
//        }
//    }
//}
